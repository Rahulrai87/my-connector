export function parseSharePointUrl(siteUrl: string): {
  siteBaseUrl: string;
  folderPath?: string;
} {
  const url = new URL(siteUrl);

  const parts = url.pathname.split('/').filter(Boolean);
  const sitesIndex = parts.indexOf('sites');

  if (sitesIndex === -1 || parts.length < sitesIndex + 2) {
    throw new Error('Invalid SharePoint site URL');
  }

  // /sites/hr
  const sitePath = parts.slice(0, sitesIndex + 2).join('/');

  // Anything after site path is folder
  const folderParts = parts.slice(sitesIndex + 2);

  return {
    siteBaseUrl: `${url.origin}/${sitePath}`,
    folderPath: folderParts.length
      ? `/${folderParts.join('/')}`
      : undefined,
  };
}
