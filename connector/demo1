async folderExists(
  driveId: string,
  folderPath: string, // e.g. "Invoices/2024/January"
): Promise<{ exists: boolean; folder?: any }> {
  try {
    // Graph requires colon-wrapped path
    const normalizedPath = folderPath
      .split('/')
      .map(encodeURIComponent)
      .join('/');

    const item = await this.client
      .api(`/drives/${driveId}/root:/${normalizedPath}`)
      .select('id,name,folder,parentReference,lastModifiedDateTime')
      .get();

    // Exists AND is a folder
    if (item.folder) {
      return { exists: true, folder: item };
    }

    return { exists: false };
  } catch (err: any) {
    // Graph returns 404 if path doesn't exist
    if (err?.statusCode === 404) {
      return { exists: false };
    }

    throw err; // real error
  }
}
